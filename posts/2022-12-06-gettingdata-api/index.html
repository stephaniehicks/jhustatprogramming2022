<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephanie Hicks">
<meta name="dcterms.date" content="2022-12-06">
<meta name="description" content="Introduction to JSON files and interacting with APIs with httr">

<title>Statistical Programming Paradigms and Workflows (BSPH 140.840) - Retrieving data from APIs with httr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Statistical Programming Paradigms and Workflows (BSPH 140.840)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-general-information" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">General Information</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-general-information">    
        <li>
    <a class="dropdown-item" href="../../syllabus.html">
 <span class="dropdown-text">Syllabus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../schedule.html">
 <span class="dropdown-text">Schedule</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-course-materials" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Course Materials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-course-materials">    
        <li>
    <a class="dropdown-item" href="../../lectures.html">
 <span class="dropdown-text">Lectures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../projects.html">
 <span class="dropdown-text">Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources.html">
 <span class="dropdown-text">Resources</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Retrieving data from APIs with <code>httr</code></h1>
                  <div>
        <div class="description">
          Introduction to JSON files and interacting with APIs with <code>httr</code>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">module 3</div>
                <div class="quarto-category">week 7</div>
                <div class="quarto-category">JSON</div>
                <div class="quarto-category">APIs</div>
                <div class="quarto-category">httr</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <a href="https://stephaniehicks.com">Stephanie Hicks</a> 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Biostatistics, Johns Hopkins
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 6, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pre-lecture-materials" id="toc-pre-lecture-materials" class="nav-link active" data-scroll-target="#pre-lecture-materials">Pre-lecture materials</a>
  <ul class="collapse">
  <li><a href="#read-ahead" id="toc-read-ahead" class="nav-link" data-scroll-target="#read-ahead">Read ahead</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  <li><a href="#install-new-packages" id="toc-install-new-packages" class="nav-link" data-scroll-target="#install-new-packages">Install new packages</a></li>
  </ul></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a>
  <ul class="collapse">
  <li><a href="#raw-vs-clean-data" id="toc-raw-vs-clean-data" class="nav-link" data-scroll-target="#raw-vs-clean-data">“Raw” vs “Clean” data</a></li>
  <li><a href="#what-do-we-mean-by-raw-data" id="toc-what-do-we-mean-by-raw-data" class="nav-link" data-scroll-target="#what-do-we-mean-by-raw-data">What do we mean by “raw” data?</a></li>
  <li><a href="#where-do-data-live" id="toc-where-do-data-live" class="nav-link" data-scroll-target="#where-do-data-live">Where do data live?</a></li>
  </ul></li>
  <li><a href="#best-practices-on-sharing-data" id="toc-best-practices-on-sharing-data" class="nav-link" data-scroll-target="#best-practices-on-sharing-data">Best practices on sharing data</a></li>
  <li><a href="#getting-data" id="toc-getting-data" class="nav-link" data-scroll-target="#getting-data">Getting data</a>
  <ul class="collapse">
  <li><a href="#json-files" id="toc-json-files" class="nav-link" data-scroll-target="#json-files">JSON files</a></li>
  <li><a href="#overview-of-apis" id="toc-overview-of-apis" class="nav-link" data-scroll-target="#overview-of-apis">Overview of APIs</a>
  <ul class="collapse">
  <li><a href="#how-do-apis-work" id="toc-how-do-apis-work" class="nav-link" data-scroll-target="#how-do-apis-work">How do APIs work?</a></li>
  <li><a href="#four-types-of-api-architectures" id="toc-four-types-of-api-architectures" class="nav-link" data-scroll-target="#four-types-of-api-architectures">Four types of API architectures</a></li>
  <li><a href="#how-to-use-an-api" id="toc-how-to-use-an-api" class="nav-link" data-scroll-target="#how-to-use-an-api">How to use an API?</a></li>
  <li><a href="#where-can-i-find-new-apis" id="toc-where-can-i-find-new-apis" class="nav-link" data-scroll-target="#where-can-i-find-new-apis">Where can I find new APIs?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#github-api" id="toc-github-api" class="nav-link" data-scroll-target="#github-api">GitHub API</a>
  <ul class="collapse">
  <li><a href="#access-the-api-from-r" id="toc-access-the-api-from-r" class="nav-link" data-scroll-target="#access-the-api-from-r">Access the API from R</a></li>
  <li><a href="#using-api-keys" id="toc-using-api-keys" class="nav-link" data-scroll-target="#using-api-keys">Using API keys</a></li>
  <li><a href="#access-api-with-httr-and-get" id="toc-access-api-with-httr-and-get" class="nav-link" data-scroll-target="#access-api-with-httr-and-get">Access API with <code>httr</code> and <code>GET</code></a></li>
  <li><a href="#a-bit-of-eda-fun" id="toc-a-bit-of-eda-fun" class="nav-link" data-scroll-target="#a-bit-of-eda-fun">A bit of EDA fun</a></li>
  <li><a href="#other-examples-with-github-api" id="toc-other-examples-with-github-api" class="nav-link" data-scroll-target="#other-examples-with-github-api">Other examples with GitHub API</a></li>
  </ul></li>
  <li><a href="#covid-act-now-api" id="toc-covid-act-now-api" class="nav-link" data-scroll-target="#covid-act-now-api">COVID Act Now API</a>
  <ul class="collapse">
  <li><a href="#register-for-an-api-key" id="toc-register-for-an-api-key" class="nav-link" data-scroll-target="#register-for-an-api-key">Register for an API Key</a></li>
  <li><a href="#building-the-url-for-get" id="toc-building-the-url-for-get" class="nav-link" data-scroll-target="#building-the-url-for-get">Building the URL for <code>GET</code></a></li>
  <li><a href="#calling-an-api-with-get" id="toc-calling-an-api-with-get" class="nav-link" data-scroll-target="#calling-an-api-with-get">Calling an API with <code>GET</code></a></li>
  <li><a href="#converting-json-to-a-data.frame" id="toc-converting-json-to-a-data.frame" class="nav-link" data-scroll-target="#converting-json-to-a-data.frame">Converting JSON to a <code>data.frame</code></a></li>
  <li><a href="#looping-multiple-api-calls" id="toc-looping-multiple-api-calls" class="nav-link" data-scroll-target="#looping-multiple-api-calls">Looping multiple API calls</a></li>
  </ul></li>
  <li><a href="#post-lecture-materials" id="toc-post-lecture-materials" class="nav-link" data-scroll-target="#post-lecture-materials">Post-lecture materials</a>
  <ul class="collapse">
  <li><a href="#other-good-r-packages-to-know-about" id="toc-other-good-r-packages-to-know-about" class="nav-link" data-scroll-target="#other-good-r-packages-to-know-about">Other good R packages to know about</a></li>
  <li><a href="#final-questions" id="toc-final-questions" class="nav-link" data-scroll-target="#final-questions">Final Questions</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="pre-lecture-materials" class="level1">
<h1>Pre-lecture materials</h1>
<section id="read-ahead" class="level3">
<h3 class="anchored" data-anchor-id="read-ahead">Read ahead</h3>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Read ahead
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Before class, you can prepare by reading the following materials:</strong></p>
<ol type="1">
<li><a href="https://jeroen.cran.dev/jsonlite" class="uri">https://jeroen.cran.dev/jsonlite</a></li>
<li><a href="https://httr.r-lib.org" class="uri">https://httr.r-lib.org</a></li>
</ol>
</div>
</div>
</section>
<section id="acknowledgements" class="level3">
<h3 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h3>
<p>Material for this lecture was borrowed and adopted from</p>
<ul>
<li><a href="https://jhu-advdatasci.github.io/2019/lectures/04-gettingdata-api.html" class="uri">https://jhu-advdatasci.github.io/2019/lectures/04-gettingdata-api.html</a></li>
<li><a href="https://aws.amazon.com/what-is/api" class="uri">https://aws.amazon.com/what-is/api</a></li>
<li><a href="https://bookdown.org/paul/apis_for_social_scientists/github.com-api.html" class="uri">https://bookdown.org/paul/apis_for_social_scientists/github.com-api.html</a></li>
<li><a href="https://statisticsglobe.com/api-in-r" class="uri">https://statisticsglobe.com/api-in-r</a></li>
</ul>
</section>
<section id="install-new-packages" class="level3">
<h3 class="anchored" data-anchor-id="install-new-packages">Install new packages</h3>
<p>Before we begin, you will need to install these packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"jsonlite"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"httr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we load a few R packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="learning-objectives" class="level1">
<h1>Learning objectives</h1>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>At the end of this lesson you will:</strong></p>
<ul>
<li>Describe what the difference is between “raw” vs “clean” data</li>
<li>Learn about what are JSON files and how we can convert them into data frames in R</li>
<li>Describe some best practices on sharing data with collaborators</li>
<li>Know what does API mean and state four types of API architectures</li>
<li>Practice with two APIs: the GitHub API and the COVID Act Now API</li>
</ul>
</div>
</div>
</section>
<section id="motivation" class="level1">
<h1>Motivation</h1>
<p>Today, we are going to talk about getting data from APIs and examples of common data formats.</p>
<p>First, let’s have a bit of a philosophical discussion about data.</p>
<section id="raw-vs-clean-data" class="level2">
<h2 class="anchored" data-anchor-id="raw-vs-clean-data">“Raw” vs “Clean” data</h2>
<p>As data analysts, this is what we wished data looked like whenever we start a project</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/tidy-data-example.png" class="img-fluid"></p>
</div>
</div>
<p>However, the reality, is data is rarely in that form in comes in all types of <em>“raw”</em> formats that need to be transformed into a <em>“clean”</em> format.</p>
<p>For example, in field of genomics, raw data looks like something like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/fastq.png" class="img-fluid"></p>
</div>
</div>
<p>Or if you are interested in analyzing data from Twitter:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/twitter-api.png" class="img-fluid"></p>
</div>
</div>
<p>Or data from Electronic Healthcare Records (EHRs):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/ehr.png" class="img-fluid"></p>
</div>
</div>
<p>We all have our scary spreadsheet tales. Here is Jenny Bryan from Posit and UBC actually asking for some of those spreadsheet tales on twitter.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/spreadsheet-tales.png" class="img-fluid"></p>
</div>
</div>
<p>For example, this is an actual <a href="https://github.com/jennybc/2016-06_spreadsheets/blob/master/2016-06_useR-stanford.pdf">spreadsheet from Enron in 2001</a>:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/enron-spreadsheet.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="what-do-we-mean-by-raw-data" class="level2">
<h2 class="anchored" data-anchor-id="what-do-we-mean-by-raw-data">What do we mean by “raw” data?</h2>
<p>From <a href="https://simplystatistics.org/posts/2016-07-20-relativity-raw-data/">https://simplystatistics.org/posts/2016-07-20-relativity-raw-data/</a> raw data is defined as data…</p>
<blockquote class="blockquote">
<p>…if you have done no processing, manipulation, coding, or analysis of the data. In other words, the file you received from the person before you is untouched. But it may not be the rawest version of the data. The person who gave you the raw data may have done some computations. They have a different “raw data set”.</p>
</blockquote>
</section>
<section id="where-do-data-live" class="level2">
<h2 class="anchored" data-anchor-id="where-do-data-live">Where do data live?</h2>
<p>Data lives anywhere and everywhere. Data might be stored simply in a <code>.csv</code> or <code>.txt</code> file. Data might be stored in an Excel or Google Spreadsheet. Data might be stored in large databases that require users to write special functions to interact with to extract the data they are interested in.</p>
<p>For example, you may have heard of the terms <code>mySQL</code> or <code>MongoDB</code>.</p>
<p>From <a href="https://en.wikipedia.org/wiki/MySQL">Wikipedia, MySQL</a> is defined as <em>an open-source relational database management system (RDBMS). Its name is a combination of “My”, the name of co-founder Michael Widenius’s daughter,[7] and “SQL”, the abbreviation for Structured Query Language</em>.</p>
<p>From <a href="https://en.wikipedia.org/wiki/MongoDB">Wikipeda, MongoDB</a> is defined as <em>“a free and open-source cross-platform document-oriented database program. Classified as a NoSQL database program, MongoDB uses JSON-like documents with schemata.”</em></p>
<p>So after reading that, we get the sense that there are multiple ways large databases can be structured, data can be formatted and interacted with. In addition, we see that database programs (e.g.&nbsp;MySQL and MongoDB) can also interact with each other.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/databases.png" class="img-fluid"></p>
</div>
</div>
<p>We will learn more about <code>JSON</code> today and learn about <code>SQL</code> in a later lecture more formally.</p>
</section>
</section>
<section id="best-practices-on-sharing-data" class="level1">
<h1>Best practices on sharing data</h1>
<p>A great article in PeerJ was written titled <a href="https://peerj.com/preprints/3139v5.pdf"><em>How to share data for collaboration</em></a>, in which the authors describe a set of guidelines for sharing data:</p>
<blockquote class="blockquote">
<p>We highlight the need to provide raw data to the statistician, the importance of consistent formatting, and the necessity of including all essential experimental information and pre-processing steps carried out to the statistician. With these guidelines we hope to avoid errors and delays in data analysis. the importance of consistent formatting, and the necessity of including all essential experimental information and pre-processing steps carried out to the statistician.</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/ellis-datashare.png" class="img-fluid"></p>
</div>
</div>
<p>It’s a great paper that describes the information you should pass to a statistician to facilitate the most efficient and timely analysis.</p>
<p>Specifically:</p>
<ol type="1">
<li>The raw data (or the rawest form of the data to which you have access)
<ul>
<li>Should not have modified, removed or summarized any data; Ran no software on data</li>
<li>e.g.&nbsp;strange binary file your measurement machine spits out</li>
<li>e.g.&nbsp;complicated JSON file you scrapped from Twitter Application Programming Interfaces (API)</li>
<li>e.g.&nbsp;hand-entered numbers you collected looking through a microscope</li>
</ul></li>
<li>A clean data set
<ul>
<li>This may or may not be transforming data into a <code>tidy</code> dataset, but possibly yes</li>
</ul></li>
<li>A code book describing each variable and its values in the clean or tidy data set.
<ul>
<li>More detailed information about the measurements in the data set (e.g.&nbsp;units, experimental design, summary choices made)</li>
<li>Doesn’t quite fit into the column names in the spreadsheet</li>
<li>Often reported in a <code>.md</code>, <code>.txt</code> or Word file.</li>
</ul></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/code-book.png" class="img-fluid"></p>
</div>
</div>
<ol start="4" type="1">
<li>An explicit and exact recipe you used to go from 1 -&gt; 2,3</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://github.com/jtleek/advdatasci/raw/master/imgs/recipe-best.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="getting-data" class="level1">
<h1>Getting data</h1>
<section id="json-files" class="level2">
<h2 class="anchored" data-anchor-id="json-files">JSON files</h2>
<p>JSON (or JavaScript Object Notation) is a file format that stores information in human-readable, organized, logical, easy-to-access manner.</p>
<p>For example, here is what a JSON file looks like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>var stephanie = {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    "age" : "33",</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    "hometown" : "Baltimore, MD",</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    "gender" : "female", </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  "cars" : {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    "car1" : "Hyundai Elantra",</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    "car2" : "Toyota Rav4",</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    "car3" : "Honda CR-V"</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some features about <code>JSON</code> objects:</p>
<ul>
<li>JSON objects are surrounded by curly braces <code>{}</code></li>
<li>JSON objects are written in key/value pairs</li>
<li>Keys must be strings, and values must be a valid JSON data type (string, number, object, array, boolean)</li>
<li>Keys and values are separated by a colon</li>
<li>Each key/value pair is separated by a comma</li>
</ul>
</section>
<section id="overview-of-apis" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-apis">Overview of APIs</h2>
<p><a href="https://aws.amazon.com/what-is/api/">From AWS</a>, API stands for <strong>Application Programming Interface</strong>.</p>
<ul>
<li>“Application” = any <strong>software</strong> with a distinct function</li>
<li>“Interface” = a <strong>contract of service</strong> between two applications. This contract defines how the two communicate with each other using requests and responses.</li>
</ul>
<p>The <strong>API documentation</strong> contains information on how developers are to structure those requests and responses.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Purpose of APIs
</div>
</div>
<div class="callout-body-container callout-body">
<p>The purpose of APIs is enable two software components to communicate with each other using a set of definitions and protocols.</p>
<p>For example, the weather bureau’s software system contains daily weather data. The weather app on your phone “talks” to this system via APIs and shows you daily weather updates on your phone.</p>
</div>
</div>
<section id="how-do-apis-work" class="level3">
<h3 class="anchored" data-anchor-id="how-do-apis-work">How do APIs work?</h3>
<p>To understand how APIs work, two terms that are important are</p>
<ol type="1">
<li><strong>client</strong>. This is the application sending the request.</li>
<li><strong>server</strong>. This is the application sending the response.</li>
</ol>
<p>So in the weather example, the bureau’s weather database is the server, and the mobile app is the client.</p>
</section>
<section id="four-types-of-api-architectures" class="level3">
<h3 class="anchored" data-anchor-id="four-types-of-api-architectures">Four types of API architectures</h3>
<p>There are four different ways that APIs can work depending on when and why they were created.</p>
<ol type="1">
<li><p><strong>SOAP APIs</strong>. These APIs use <strong>Simple Object Access Protocol</strong>. Client and server exchange messages using XML. This is a less flexible API that was more popular in the past.</p></li>
<li><p><strong>RPC APIs</strong>. These APIs are called <strong>Remote Procedure Calls</strong>. The client completes a function (or procedure) on the server, and the server sends the output back to the client.</p></li>
<li><p><strong>Websocket APIs</strong>. Websocket API is another <strong>modern web</strong> API development that uses JSON objects to pass data. A WebSocket API supports two-way communication between client apps and the server. The server can send callback messages to connected clients, making it more efficient than REST API.</p></li>
<li><p><strong>REST APIs</strong>. REST stands for <strong>Representational State Transfer</strong> (and are the most popular and flexible APIs). The client sends requests to the server as data. The server uses this client input to start internal functions and returns output data back to the client. REST defines a set of functions like GET, PUT, DELETE, etc. that clients can use to access server data. Clients and servers exchange data using HTTP.</p></li>
</ol>
<p>The main feature of REST API is <strong>statelessness</strong> (i.e.&nbsp;servers do not save client data between requests). Client requests to the server are similar to URLs you type in your browser to visit a website. The response from the server is plain data, without the typical graphical rendering of a web page.</p>
</section>
<section id="how-to-use-an-api" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-an-api">How to use an API?</h3>
<p>The basic steps to using an API are:</p>
<ol type="1">
<li><strong>Obtaining an API key</strong>. This is done by creating a verified account with the API provider.</li>
<li><strong>Set up an HTTP API client</strong>. This tool allows you to structure API requests easily using the API keys received. Here, we will use the <code>GET()</code> function from the <code>httr</code> package.</li>
<li>If you don’t have an API client, you can try to structure the request yourself in your browser by referring to the API documentation.</li>
<li>Once you are comfortable with the new API syntax, you can start using it in your code.</li>
</ol>
</section>
<section id="where-can-i-find-new-apis" class="level3">
<h3 class="anchored" data-anchor-id="where-can-i-find-new-apis">Where can I find new APIs?</h3>
<p>New web APIs can be found on API marketplaces and API directories, such as:</p>
<ul>
<li><a href="https://rapidapi.com/">Rapid API</a> – One of the largest global API markets (10k+ public APIs). Users to test APIs directly on the platform before committing to purchase.</li>
<li><a href="https://documenter.getpostman.com/view/8854915/Szf7znEe">Public REST APIs</a> – Groups REST APIs into categories, making it easier to browse and find the right one to meet your needs.</li>
<li><a href="https://apiforthat.posthaven.com/">APIForThat</a> and <a href="https://apilist.fun">APIList</a> – Both these websites have lists of 500+ web APIs, along with in-depth information on how to use them.</li>
</ul>
</section>
</section>
</section>
<section id="github-api" class="level1">
<h1>GitHub API</h1>
<p>The <a href="https://docs.github.com/en/rest">GitHub REST API</a> may be of interest when studying online communities, working methods, organizational structures, communication and discussions, etc. with a focus on (open-source) software development.</p>
<p>Many projects that are hosted on GitHub are open-source projects with a transparent development process and communications. For private projects, which can also be hosted on GitHub, there’s understandably only a few aggregate data available.</p>
<p>Let’s say we want to use the <a href="https://docs.github.com/en/rest">GitHub REST API</a> to find out how many of my GitHub repositories have open issues?</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Pro-tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The API can be used for free and you can send up to 60 requests per hour if you are not authenticated (i.e.&nbsp;if you don’t provide an API key).</p>
<p>For serious data collection, this is not much, so it is recommended to sign up on GitHub and generate a personal access token that acts as API key.</p>
<p>This token can then be used to authenticate your API requests. Your quota is then 5000 requests per hour.</p>
</div>
</div>
<section id="access-the-api-from-r" class="level2">
<h2 class="anchored" data-anchor-id="access-the-api-from-r">Access the API from R</h2>
<p>There are packages for many programming languages that provide convenient access for communicating with the GitHub API, but there are no such packages (that I’m aware of) for accessing the API from R.</p>
<p>This means we can only access the API directly, e.g.&nbsp;by using the <a href="https://cran.r-project.org/web/packages/jsonlite/index.html"><code>jsonlite</code></a> package to fetch the data and convert it to an R <code>list</code> or <code>data.frame</code>.</p>
<p>Specifically, we will use the <code>jsonlite::fromJSON()</code> function to convert from a JSON object to a data frame.</p>
<p>The JSON file is located at <a href="https://api.github.com/users/stephaniehicks/repos">https://api.github.com/users/stephaniehicks/repos</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>github_url <span class="ot">=</span> <span class="st">"https://api.github.com/users/stephaniehicks/repos"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>jsonData <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">fromJSON</span>(github_url))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(jsonData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30
Columns: 79
$ id                          &lt;int&gt; 160194123, 132884754, 225501707, 63822882,…
$ node_id                     &lt;chr&gt; "MDEwOlJlcG9zaXRvcnkxNjAxOTQxMjM=", "MDEwO…
$ name                        &lt;chr&gt; "2018-bioinfosummer-scrnaseq", "advdatasci…
$ full_name                   &lt;chr&gt; "stephaniehicks/2018-bioinfosummer-scrnase…
$ private                     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
$ owner                       &lt;df[,18]&gt; &lt;data.frame[26 x 18]&gt;
$ html_url                    &lt;chr&gt; "https://github.com/stephaniehicks/201…
$ description                 &lt;chr&gt; NA, NA, "A curated list of bioinformatics …
$ fork                        &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, FALSE, FALSE, FAL…
$ url                         &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ forks_url                   &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ keys_url                    &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ collaborators_url           &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ teams_url                   &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ hooks_url                   &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ issue_events_url            &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ events_url                  &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ assignees_url               &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ branches_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ tags_url                    &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ blobs_url                   &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ git_tags_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ git_refs_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ trees_url                   &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ statuses_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ languages_url               &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ stargazers_url              &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ contributors_url            &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ subscribers_url             &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ subscription_url            &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ commits_url                 &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ git_commits_url             &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ comments_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ issue_comment_url           &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ contents_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ compare_url                 &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ merges_url                  &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ archive_url                 &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ downloads_url               &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ issues_url                  &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ pulls_url                   &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ milestones_url              &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ notifications_url           &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ labels_url                  &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ releases_url                &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ deployments_url             &lt;chr&gt; "https://api.github.com/repos/stephaniehic…
$ created_at                  &lt;chr&gt; "2018-12-03T13:20:45Z", "2018-05-10T10:22:…
$ updated_at                  &lt;chr&gt; "2019-08-08T02:18:17Z", "2018-05-10T10:22:…
$ pushed_at                   &lt;chr&gt; "2018-12-05T17:07:09Z", "2017-12-18T17:18:…
$ git_url                     &lt;chr&gt; "git://github.com/stephaniehicks/2018-bioi…
$ ssh_url                     &lt;chr&gt; "git@github.com:stephaniehicks/2018-bioinf…
$ clone_url                   &lt;chr&gt; "https://github.com/stephaniehicks/2018-bi…
$ svn_url                     &lt;chr&gt; "https://github.com/stephaniehicks/2018-bi…
$ homepage                    &lt;chr&gt; NA, NA, NA, NA, "", NA, NA, NA, NA, NA, NA…
$ size                        &lt;int&gt; 60296, 172353, 121, 675, 26688, 20, 92401,…
$ stargazers_count            &lt;int&gt; 4, 0, 1, 0, 0, 1, 8, 0, 1, 0, 14, 3, 0, 0,…
$ watchers_count              &lt;int&gt; 4, 0, 1, 0, 0, 1, 8, 0, 1, 0, 14, 3, 0, 0,…
$ language                    &lt;chr&gt; "TeX", "HTML", NA, NA, "R", "R", "Jupyter …
$ has_issues                  &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, TRU…
$ has_projects                &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, …
$ has_downloads               &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, …
$ has_wiki                    &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, …
$ has_pages                   &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, F…
$ has_discussions             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
$ forks_count                 &lt;int&gt; 4, 0, 0, 1, 1, 0, 2, 0, 0, 1, 4, 1, 1, 0, …
$ mirror_url                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ archived                    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
$ disabled                    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
$ open_issues_count           &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ license                     &lt;df[,5]&gt; &lt;data.frame[26 x 5]&gt;
$ allow_forking               &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, …
$ is_template                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALS…
$ web_commit_signoff_required &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
$ topics                      &lt;list&gt; &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;…
$ visibility                  &lt;chr&gt; "public", "public", "public", "public", "p…
$ forks                       &lt;int&gt; 4, 0, 0, 1, 1, 0, 2, 0, 0, 1, 4, 1, 1, 0,…
$ open_issues                 &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ watchers                    &lt;int&gt; 4, 0, 1, 0, 0, 1, 8, 0, 1, 0, 14, 3, 0, 0,…
$ default_branch              &lt;chr&gt; "master", "master", "master", "master", "m…</code></pre>
</div>
</div>
<p>The function <code>fromJSON()</code> has now converted the JSON file into a data frame.</p>
<p>However, from here, we see that there are only 30 rows (or 30 repositories). If you look on my github page, you can see there are more than 30 repositories.</p>
<ul>
<li><a href="https://github.com/stephaniehicks?tab=repositories" class="uri">https://github.com/stephaniehicks?tab=repositories</a></li>
</ul>
<p>I have 85 public repositories as of today!</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
APIs limit info from users
</div>
</div>
<div class="callout-body-container callout-body">
<p>What’s happening is called <strong>pagination</strong>.</p>
<p>At a high-level, the API is limiting the amount of items a user gets and <strong>splitting it into pages</strong>.</p>
<p>Formally, pagination is the process of splitting the contents or a section of a website into discrete pages. Users tend to get lost when there’s bunch of data and with pagination splitting they can concentrate on a particular amount of content. Hierarchy and paginated structure improve the readability score of the content.</p>
<p>In this use case Github api splits the result into 30 items per resonse, depends on the request</p>
</div>
</div>
<p><strong>Solution</strong>: You should explicitly specify in your request how many items you would like to receive from server pagination engine, using formula for Github pagination api:</p>
<p><code>?page=1&amp;per_page=&lt;numberOfItemsYouSpecify&gt;"</code></p>
<p>You can read more about pagination here:</p>
<ul>
<li><a href="https://docs.github.com/en/enterprise-server@3.6/rest/guides/traversing-with-pagination" class="uri">https://docs.github.com/en/enterprise-server@3.6/rest/guides/traversing-with-pagination</a></li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here we can visit this website:</p>
<ul>
<li><a href="https://api.github.com/users/stephaniehicks/repos?page=1&amp;per_page=1000" class="uri">https://api.github.com/users/stephaniehicks/repos?page=1&amp;per_page=1000</a></li>
</ul>
<p>And see there are more than 30 repos. Let’s read it into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>github_url <span class="ot">=</span> <span class="st">"https://api.github.com/users/stephaniehicks/repos?page=1&amp;per_page=1000"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>jsonDataAll <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">fromJSON</span>(github_url))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(jsonDataAll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85 79</code></pre>
</div>
</div>
<p>We now get all 85 repositories! yay!</p>
</div>
</div>
</section>
<section id="using-api-keys" class="level2">
<h2 class="anchored" data-anchor-id="using-api-keys">Using API keys</h2>
<p>Authenticating with the GitHub API via an API key allows you to send much more requests to the API.</p>
<p>API access keys for the GitHub API are called <strong>personal access tokens</strong> (PAT) and the <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">documentation explains how to generate a PAT</a> once you have logged into your GitHub account.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Where to store API keys
</div>
</div>
<div class="callout-body-container callout-body">
<p>First, <strong>please be careful with your PATs and never publish them.</strong></p>
<p>If you want guidance on where you should store them, I like this post:</p>
<ul>
<li><a href="https://www.r-bloggers.com/2015/11/how-to-store-and-use-webservice-keys-and-authentication-details-with-r/" class="uri">https://www.r-bloggers.com/2015/11/how-to-store-and-use-webservice-keys-and-authentication-details-with-r/</a></li>
</ul>
<p>Personally, I keep mine in my <code>.Renviron</code> file which looks something like this on the inside:</p>
<pre><code>GITHUB_API_KEY = &lt;add my GitHub API key here&gt; 
COVID_ACT_NOW_API_KEY = &lt;add my COVID Act Now API key here&gt; 
CENSUS_API_KEY = &lt;add my tidycensus API key here&gt; </code></pre>
<p>If you don’t have an <code>.Renviron</code> file in your home directory, you can make one:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> .Renviron</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Assuming you have created and stored an API key in the <code>.Renviron</code> file in your home directory, you can fetch it with the <code>Sys.getenv()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>github_key <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"GITHUB_API_KEY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use this in a little bit.</p>
</section>
<section id="access-api-with-httr-and-get" class="level2">
<h2 class="anchored" data-anchor-id="access-api-with-httr-and-get">Access API with <code>httr</code> and <code>GET</code></h2>
<p>There are a set of <a href="https://docs.oracle.com/en/cloud/saas/marketing/eloqua-develop/Developers/GettingStarted/APIRequests/HTTP-verbs.htm">basic HTTP verbs</a> that allow you access a set of <strong>endpoints</strong>.</p>
<p>The basic request patterns are:</p>
<ul>
<li>Retrieve a single item (GET)</li>
<li>Retrieve a list of items (GET)</li>
<li>Create an item (POST)</li>
<li>Update an item (PUT)</li>
<li>Delete an item (DELETE)</li>
</ul>
<p>Here, we will use the <code>GET()</code> function from <a href="https://cran.r-project.org/web/packages/httr/index.html"><code>httr</code></a> package (i.e.&nbsp;tools to work with URLs and HTTP) to retrieve a single JSON file.</p>
<p>We will also make this an <strong>authenticated HTTP response</strong> to the GitHub API using <code>authenticate()</code> from the <code>httr</code> package.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s start by using the GitHub API to learn information about myself (Stephanie Hicks)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>github_key <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"GITHUB_API_KEY"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">'https://api.github.com/user'</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">authenticate</span>(<span class="at">user =</span> <span class="st">'stephaniehicks'</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">password =</span> github_key))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>response</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response [https://api.github.com/user]
  Date: 2022-12-06 18:29
  Status: 200
  Content-Type: application/json; charset=utf-8
  Size: 1.48 kB
{
  "login": "stephaniehicks",
  "id": 1452065,
  "node_id": "MDQ6VXNlcjE0NTIwNjU=",
  "avatar_url": "https://avatars.githubusercontent.com/u/1452065?v=4",
  "gravatar_id": "",
  "url": "https://api.github.com/users/stephaniehicks",
  "html_url": "https://github.com/stephaniehicks",
  "followers_url": "https://api.github.com/users/stephaniehicks/followers",
  "following_url": "https://api.github.com/users/stephaniehicks/following{/ot...
...</code></pre>
</div>
</div>
<p>We see the response we got is a JSON file.</p>
</div>
</div>
<p>Next we extract / retrieve the contents from the raw JSON output using the <code>content()</code> function from the <code>httr</code> package. If you use the argument <code>as = 'text'</code>, it extracts the contents as a character vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>account_details <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(httr<span class="sc">::</span><span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">'text'</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>account_details</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$login
[1] "stephaniehicks"

$id
[1] 1452065

$node_id
[1] "MDQ6VXNlcjE0NTIwNjU="

$avatar_url
[1] "https://avatars.githubusercontent.com/u/1452065?v=4"

$gravatar_id
[1] ""

$url
[1] "https://api.github.com/users/stephaniehicks"

$html_url
[1] "https://github.com/stephaniehicks"

$followers_url
[1] "https://api.github.com/users/stephaniehicks/followers"

$following_url
[1] "https://api.github.com/users/stephaniehicks/following{/other_user}"

$gists_url
[1] "https://api.github.com/users/stephaniehicks/gists{/gist_id}"

$starred_url
[1] "https://api.github.com/users/stephaniehicks/starred{/owner}{/repo}"

$subscriptions_url
[1] "https://api.github.com/users/stephaniehicks/subscriptions"

$organizations_url
[1] "https://api.github.com/users/stephaniehicks/orgs"

$repos_url
[1] "https://api.github.com/users/stephaniehicks/repos"

$events_url
[1] "https://api.github.com/users/stephaniehicks/events{/privacy}"

$received_events_url
[1] "https://api.github.com/users/stephaniehicks/received_events"

$type
[1] "User"

$site_admin
[1] FALSE

$name
[1] "Stephanie Hicks"

$company
[1] "Johns Hopkins"

$blog
[1] "http://www.stephaniehicks.com"

$location
[1] "Baltimore, MD"

$email
NULL

$hireable
NULL

$bio
[1] "Associate Prof at Johns Hopkins Biostatistics"

$twitter_username
[1] "stephaniehicks"

$public_repos
[1] 85

$public_gists
[1] 8

$followers
[1] 233

$following
[1] 16

$created_at
[1] "2012-02-19T21:18:27Z"

$updated_at
[1] "2022-11-29T18:35:36Z"</code></pre>
</div>
</div>
<p>Next, let’s perform the same request we did above about my 85 repositories, but instead of reading in the JSON file from the web, we use an authenticated <code>GET()</code> response:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">'https://api.github.com/users/stephaniehicks/repos?page=1&amp;per_page=1000'</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">authenticate</span>(<span class="st">'stephaniehicks'</span>, github_key))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>repo_details <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">fromJSON</span>(httr<span class="sc">::</span><span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">'text'</span>)))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>repo_details</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 85 × 80
          id node_id   name  full_…¹ private owner…² html_…³ descr…⁴ fork  url  
       &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;lgl&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;lgl&gt; &lt;chr&gt;
 1 160194123 MDEwOlJl… 2018… stepha… FALSE   stepha… https:… &lt;NA&gt;    FALSE http…
 2 132884754 MDEwOlJl… advd… stepha… FALSE   stepha… https:… &lt;NA&gt;    TRUE  http…
 3 225501707 MDEwOlJl… Awes… stepha… FALSE   stepha… https:… A cura… TRUE  http…
 4  63822882 MDEwOlJl… awes… stepha… FALSE   stepha… https:… List o… TRUE  http…
 5  16586187 MDEwOlJl… Back… stepha… FALSE   stepha… https:… Gene e… FALSE http…
 6 287533539 MDEwOlJl… benc… stepha… FALSE   stepha… https:… &lt;NA&gt;    FALSE http…
 7 168789632 MDEwOlJl… benc… stepha… FALSE   stepha… https:… Benchm… FALSE http…
 8 140320609 MDEwOlJl… benc… stepha… FALSE   stepha… https:… Reposi… FALSE http…
 9 178318764 MDEwOlJl… benc… stepha… FALSE   stepha… https:… Data a… FALSE http…
10 313126225 MDEwOlJl… bioc… stepha… FALSE   stepha… https:… &lt;NA&gt;    FALSE http…
# … with 75 more rows, 87 more variables: owner$id &lt;int&gt;, $node_id &lt;chr&gt;,
#   $avatar_url &lt;chr&gt;, $gravatar_id &lt;chr&gt;, $url &lt;chr&gt;, $html_url &lt;chr&gt;,
#   $followers_url &lt;chr&gt;, $following_url &lt;chr&gt;, $gists_url &lt;chr&gt;,
#   $starred_url &lt;chr&gt;, $subscriptions_url &lt;chr&gt;, $organizations_url &lt;chr&gt;,
#   $repos_url &lt;chr&gt;, $events_url &lt;chr&gt;, $received_events_url &lt;chr&gt;,
#   $type &lt;chr&gt;, $site_admin &lt;lgl&gt;, forks_url &lt;chr&gt;, keys_url &lt;chr&gt;,
#   collaborators_url &lt;chr&gt;, teams_url &lt;chr&gt;, hooks_url &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="a-bit-of-eda-fun" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-of-eda-fun">A bit of EDA fun</h2>
<p>Let’s have a bit of fun and explore some questions:</p>
<ul>
<li>How many are private repos?</li>
<li>How many have forks? How many forks?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(repo_details<span class="sc">$</span>private)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
   85 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(repo_details<span class="sc">$</span>forks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  1  2  3  4  5  6  8 11 
56 11  3  2  7  1  2  2  1 </code></pre>
</div>
</div>
<p>What’s the most popular language?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(repo_details<span class="sc">$</span>language)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
            HTML       JavaScript Jupyter Notebook         Makefile 
              20                4                1                1 
            Perl                R             Ruby            Shell 
               1               28                3                2 
             TeX 
               5 </code></pre>
</div>
</div>
<p>To find out how many repos that I have with open issues, we can just create a table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many repos have open issues? </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(repo_details<span class="sc">$</span>open_issues_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  1  2  3 
79  3  2  1 </code></pre>
</div>
</div>
<p>Whew! Not as many as I thought.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
More about <code>GET</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can use the <code>query</code> argument to specify details about the response.</p>
<p>Let’s look how many open issues there are in the <code>dplyr</code> package in the <code>tidyverse</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>req <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"https://api.github.com/repos/tidyverse/dplyr/issues"</span>, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">query =</span> <span class="fu">list</span>(<span class="at">state =</span> <span class="st">"open"</span>, <span class="at">per_page =</span> <span class="dv">100</span>, <span class="at">page =</span> <span class="dv">1</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>dplyr_details <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">fromJSON</span>(httr<span class="sc">::</span><span class="fu">content</span>(req, <span class="at">as =</span> <span class="st">'text'</span>)))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>dplyr_details</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 × 30
   url       repos…¹ label…² comme…³ event…⁴ html_…⁵     id node_id number title
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;
 1 https://… https:… https:… https:… https:… https:… 1.48e9 I_kwDO…   6588 ".by…
 2 https://… https:… https:… https:… https:… https:… 1.48e9 I_kwDO…   6587 "arr…
 3 https://… https:… https:… https:… https:… https:… 1.47e9 I_kwDO…   6585 "Sug…
 4 https://… https:… https:… https:… https:… https:… 1.47e9 I_kwDO…   6582 "Sho…
 5 https://… https:… https:… https:… https:… https:… 1.47e9 I_kwDO…   6580 "Mak…
 6 https://… https:… https:… https:… https:… https:… 1.47e9 I_kwDO…   6565 "Fee…
 7 https://… https:… https:… https:… https:… https:… 1.46e9 I_kwDO…   6560 "`fi…
 8 https://… https:… https:… https:… https:… https:… 1.46e9 PR_kwD…   6550 "Loo…
 9 https://… https:… https:… https:… https:… https:… 1.45e9 I_kwDO…   6545 "`ac…
10 https://… https:… https:… https:… https:… https:… 1.44e9 I_kwDO…   6532 "Alt…
# … with 16 more rows, 20 more variables: user &lt;df[,18]&gt;, labels &lt;list&gt;,
#   state &lt;chr&gt;, locked &lt;lgl&gt;, assignee &lt;df[,18]&gt;, assignees &lt;list&gt;,
#   milestone &lt;df[,16]&gt;, comments &lt;int&gt;, created_at &lt;chr&gt;, updated_at &lt;chr&gt;,
#   closed_at &lt;lgl&gt;, author_association &lt;chr&gt;, active_lock_reason &lt;lgl&gt;,
#   body &lt;chr&gt;, reactions &lt;df[,10]&gt;, timeline_url &lt;chr&gt;,
#   performed_via_github_app &lt;lgl&gt;, state_reason &lt;lgl&gt;, draft &lt;lgl&gt;,
#   pull_request &lt;df[,5]&gt;, and abbreviated variable names ¹​repository_url, …</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="other-examples-with-github-api" class="level2">
<h2 class="anchored" data-anchor-id="other-examples-with-github-api">Other examples with GitHub API</h2>
<p>Finally, I will leave you with a few other examples of using GitHub API:</p>
<ul>
<li><a href="https://blog.exploratory.io/analyzing-issue-data-with-github-rest-api-63945017dedc">How long does it take to close a GitHub Issue in the <code>dplyr</code> package?</a></li>
<li><a href="https://stackoverflow.com/questions/9179828/github-api-retrieve-all-commits-for-all-branches-for-a-repo">How to retrieve all commits for a branch</a></li>
<li><a href="https://masalmon.eu/2017/12/21/wherehaveyoubeen/">Getting my GitHub Activity</a></li>
</ul>
</section>
</section>
<section id="covid-act-now-api" class="level1">
<h1>COVID Act Now API</h1>
<p>Next, we will demonstrate how to request data from the API at <a href="https://covidactnow.org/data-api">COVID Act Now</a>, which returns CSV or JSON files.</p>
<p>This API provides access to COVID data tracking US states, counties, and metros, including data and metrics for cases, vaccinations, tests, hospitalizations, and deaths. See <a href="https://apidocs.covidactnow.org/data-definitions/">data definitions</a> for all included data.</p>
<section id="register-for-an-api-key" class="level2">
<h2 class="anchored" data-anchor-id="register-for-an-api-key">Register for an API Key</h2>
<p>First, you need to register for an API key here</p>
<ul>
<li><a href="https://apidocs.covidactnow.org/#register" class="uri">https://apidocs.covidactnow.org/#register</a></li>
</ul>
<p>You should also store the API key in your <code>.Renviron</code> like above for the GitHub API key.</p>
</section>
<section id="building-the-url-for-get" class="level2">
<h2 class="anchored" data-anchor-id="building-the-url-for-get">Building the URL for <code>GET</code></h2>
<p>First, we will request time series COVID data for one county in the US (Baltimore City) defined by it FIPS code (24510).</p>
<p>The URL we want is the following</p>
<pre><code>https://api.covidactnow.org/v2/county/24510.timeseries.json?apiKey=&lt;your_API_key_here&gt;</code></pre>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You cannot use this API without an API key</p>
<p>e.g.&nbsp;if we click here <a href="https://api.covidactnow.org/v2/county/24510.timeseries.json" class="uri">https://api.covidactnow.org/v2/county/24510.timeseries.json</a> it says</p>
<pre><code>{"error": "API key required. Visit https://apidocs.covidactnow.org/#register to get an API key"}</code></pre>
</div>
</div>
<p>Let’s build up the URL.</p>
<ul>
<li>The first is the base URL: <code>https://api.covidactnow.org/v2/</code>. This part of the URL <strong>will be the same for all our calls</strong> to this API.</li>
<li>The county/portion of the URL indicates that we only want COVID data for a single county. By looking at the COVID Act Now API documentation, I can see that states is an alternative option for this part of the URL.</li>
<li>24510 is the unique identifier for Baltimore City. If I want to get the same data but for a different county, I just have to change this number.</li>
<li><code>.timeseries</code> provides the API with more information about the data I am requesting, and</li>
<li><code>.json</code> tells the API to format the data as a JSON (which we will convert to a data frame).</li>
<li>Everything after <code>apiKey=</code> is my authorization token, which tells the COVID Act Now servers that I am allowed to ask for this data.</li>
</ul>
<p>Now that we have dissected the anatomy of an API, you can see how easy it is to build them!</p>
<p>Basically anybody with an internet connection, an authorization token, and who knows the grammar of the API can access it. Most APIs are published with extensive documentation to help you understand the available options and parameters.</p>
</section>
<section id="calling-an-api-with-get" class="level2">
<h2 class="anchored" data-anchor-id="calling-an-api-with-get">Calling an API with <code>GET</code></h2>
<p>Let’s join the URL together for one county (later I will show how to loop through multiple counties)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## extract my API from `.Renviron`</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>covid_key <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"COVID_ACT_NOW_API_KEY"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## build the URL</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="st">'https://api.covidactnow.org/v2/county/'</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">'24510'</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>info_key <span class="ot">&lt;-</span> <span class="st">'.timeseries.json?apiKey='</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="do">## put it all together</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>API_URL <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base, county, info_key, covid_key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have the entire URL stored in a simple R object called <code>API_URL</code>.</p>
<p>We can now use the URL to call the API, and we will store the returned data in an object called <code>raw_data</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">GET</span>(API_URL)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>raw_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response [https://api.covidactnow.org/v2/county/24510.timeseries.json?apiKey=b228d58133a04e3186e5ce081f73bbf5]
  Date: 2022-12-06 18:29
  Status: 200
  Content-Type: application/json
  Size: 1.34 MB</code></pre>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Pro-tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can see <code>status</code> element of the list. Traditionally, a status of “200” means that the API call was successful, and other codes are used to indicate errors. You can troubleshoot those error codes using the API documentation.</p>
</div>
</div>
<p>Next, we can inspect the object and we see that it is a list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(raw_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ url        : chr "https://api.covidactnow.org/v2/county/24510.timeseries.json?apiKey=b228d58133a04e3186e5ce081f73bbf5"
 $ status_code: int 200
 $ headers    :List of 16
  ..$ content-type                : chr "application/json"
  ..$ x-amz-id-2                  : chr "1Zbs9YrvpaiBiFMTsb0imkgtLHOELu8G0JopXchPmJIwWN/qJoo6W3zgvweFYN1fU0VU1NY2tCicyiSxMuq/hw=="
  ..$ x-amz-request-id            : chr "HAJVVPHDJ8D03R8K"
  ..$ date                        : chr "Tue, 06 Dec 2022 18:29:11 GMT"
  ..$ access-control-allow-origin : chr "*"
  ..$ access-control-allow-methods: chr "GET"
  ..$ last-modified               : chr "Tue, 06 Dec 2022 15:23:54 GMT"
  ..$ etag                        : chr "W/\"10d0f86efbf0c1846bf70a19394e8d29\""
  ..$ x-amz-version-id            : chr "6dSBQTzjCLxCzOiu3TC3P51hA3gYmcTs"
  ..$ server                      : chr "AmazonS3"
  ..$ content-encoding            : chr "gzip"
  ..$ vary                        : chr "Accept-Encoding"
  ..$ x-cache                     : chr "Miss from cloudfront"
  ..$ via                         : chr "1.1 c7705692ed008dad7e46e32f966aa3fe.cloudfront.net (CloudFront)"
  ..$ x-amz-cf-pop                : chr "JFK50-P8"
  ..$ x-amz-cf-id                 : chr "0E0pZr1-jowcMvOTp00B64tKiNeVNfh1_RSuB_ZGBra-XjH47tNBmw=="
  ..- attr(*, "class")= chr [1:2] "insensitive" "list"
 $ all_headers:List of 1
  ..$ :List of 3
  .. ..$ status : int 200
  .. ..$ version: chr "HTTP/2"
  .. ..$ headers:List of 16
  .. .. ..$ content-type                : chr "application/json"
  .. .. ..$ x-amz-id-2                  : chr "1Zbs9YrvpaiBiFMTsb0imkgtLHOELu8G0JopXchPmJIwWN/qJoo6W3zgvweFYN1fU0VU1NY2tCicyiSxMuq/hw=="
  .. .. ..$ x-amz-request-id            : chr "HAJVVPHDJ8D03R8K"
  .. .. ..$ date                        : chr "Tue, 06 Dec 2022 18:29:11 GMT"
  .. .. ..$ access-control-allow-origin : chr "*"
  .. .. ..$ access-control-allow-methods: chr "GET"
  .. .. ..$ last-modified               : chr "Tue, 06 Dec 2022 15:23:54 GMT"
  .. .. ..$ etag                        : chr "W/\"10d0f86efbf0c1846bf70a19394e8d29\""
  .. .. ..$ x-amz-version-id            : chr "6dSBQTzjCLxCzOiu3TC3P51hA3gYmcTs"
  .. .. ..$ server                      : chr "AmazonS3"
  .. .. ..$ content-encoding            : chr "gzip"
  .. .. ..$ vary                        : chr "Accept-Encoding"
  .. .. ..$ x-cache                     : chr "Miss from cloudfront"
  .. .. ..$ via                         : chr "1.1 c7705692ed008dad7e46e32f966aa3fe.cloudfront.net (CloudFront)"
  .. .. ..$ x-amz-cf-pop                : chr "JFK50-P8"
  .. .. ..$ x-amz-cf-id                 : chr "0E0pZr1-jowcMvOTp00B64tKiNeVNfh1_RSuB_ZGBra-XjH47tNBmw=="
  .. .. ..- attr(*, "class")= chr [1:2] "insensitive" "list"
 $ cookies    :'data.frame':    0 obs. of  7 variables:
  ..$ domain    : logi(0) 
  ..$ flag      : logi(0) 
  ..$ path      : logi(0) 
  ..$ secure    : logi(0) 
  ..$ expiration: 'POSIXct' num(0) 
  ..$ name      : logi(0) 
  ..$ value     : logi(0) 
 $ content    : raw [1:1338019] 7b 22 66 69 ...
 $ date       : POSIXct[1:1], format: "2022-12-06 18:29:11"
 $ times      : Named num [1:6] 0 0.0353 0.0479 0.0669 0.294 ...
  ..- attr(*, "names")= chr [1:6] "redirect" "namelookup" "connect" "pretransfer" ...
 $ request    :List of 7
  ..$ method    : chr "GET"
  ..$ url       : chr "https://api.covidactnow.org/v2/county/24510.timeseries.json?apiKey=b228d58133a04e3186e5ce081f73bbf5"
  ..$ headers   : Named chr "application/json, text/xml, application/xml, */*"
  .. ..- attr(*, "names")= chr "Accept"
  ..$ fields    : NULL
  ..$ options   :List of 2
  .. ..$ useragent: chr "libcurl/7.84.0 r-curl/4.3.3 httr/1.4.4"
  .. ..$ httpget  : logi TRUE
  ..$ auth_token: NULL
  ..$ output    : list()
  .. ..- attr(*, "class")= chr [1:2] "write_memory" "write_function"
  ..- attr(*, "class")= chr "request"
 $ handle     :Class 'curl_handle' &lt;externalptr&gt; 
 - attr(*, "class")= chr "response"</code></pre>
</div>
</div>
<p>One of the elements is <code>content</code> and we can inspect that</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(raw_data<span class="sc">$</span>content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> raw [1:1338019] 7b 22 66 69 ...</code></pre>
</div>
</div>
<p>We see the actual data have been stored as raw vectors (or raw bytes), which need to be converted to character vectors. This is not in a useable format yet.</p>
</section>
<section id="converting-json-to-a-data.frame" class="level2">
<h2 class="anchored" data-anchor-id="converting-json-to-a-data.frame">Converting JSON to a <code>data.frame</code></h2>
<p>There is a function in base R <code>rawTo_Char()</code> that converts raw bytes to characters</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>covid_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(raw_data<span class="sc">$</span>content), <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This converts the raw data into a list.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can also do this with <code>httr::content</code> (as above) and just define the encoding for the character set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>covid_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(httr<span class="sc">::</span><span class="fu">content</span>(raw_data, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">as =</span> <span class="st">'text'</span>, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">encoding =</span>  <span class="st">"UTF-8"</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(covid_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 25
 $ fips                          : chr "24510"
 $ country                       : chr "US"
 $ state                         : chr "MD"
 $ county                        : chr "Baltimore city"
 $ hsa                           : chr "016"
 $ hsaName                       : chr "Baltimore, MD - Baltimore City, MD"
 $ level                         : chr "county"
 $ lat                           : NULL
 $ locationId                    : chr "iso1:us#iso2:us-md#fips:24510"
 $ long                          : NULL
 $ population                    : int 593490
 $ hsaPopulation                 : int 2586756
 $ metrics                       :List of 13
  ..$ testPositivityRatio            : num 0.054
  ..$ testPositivityRatioDetails     :List of 1
  .. ..$ source: chr "other"
  ..$ caseDensity                    : num 20.9
  ..$ weeklyNewCasesPer100k          : num 146
  ..$ contactTracerCapacityRatio     : NULL
  ..$ infectionRate                  : num 1.11
  ..$ infectionRateCI90              : num 0.19
  ..$ icuCapacityRatio               : num 0.84
  ..$ bedsWithCovidPatientsRatio     : num 0.041
  ..$ weeklyCovidAdmissionsPer100k   : num 8
  ..$ vaccinationsInitiatedRatio     : num 0.769
  ..$ vaccinationsCompletedRatio     : num 0.674
  ..$ vaccinationsAdditionalDoseRatio: num 0.364
 $ riskLevels                    :List of 6
  ..$ overall                   : int 2
  ..$ testPositivityRatio       : int 1
  ..$ caseDensity               : int 2
  ..$ contactTracerCapacityRatio: int 4
  ..$ infectionRate             : int 2
  ..$ icuCapacityRatio          : int 2
 $ cdcTransmissionLevel          : int 3
 $ communityLevels               :List of 2
  ..$ cdcCommunityLevel: int 0
  ..$ canCommunityLevel: int 0
 $ actuals                       :List of 18
  ..$ cases                            : int 141637
  ..$ deaths                           : int 1898
  ..$ positiveTests                    : NULL
  ..$ negativeTests                    : NULL
  ..$ contactTracers                   : NULL
  ..$ hospitalBeds                     :List of 4
  .. ..$ capacity             : int 3546
  .. ..$ currentUsageTotal    : int 2945
  .. ..$ currentUsageCovid    : int 128
  .. ..$ weeklyCovidAdmissions: int 94
  ..$ hsaHospitalBeds                  :List of 4
  .. ..$ capacity             : int 5795
  .. ..$ currentUsageTotal    : int 4879
  .. ..$ currentUsageCovid    : int 249
  .. ..$ weeklyCovidAdmissions: int 230
  ..$ icuBeds                          :List of 3
  .. ..$ capacity         : int 422
  .. ..$ currentUsageTotal: int 355
  .. ..$ currentUsageCovid: int 9
  ..$ hsaIcuBeds                       :List of 3
  .. ..$ capacity         : int 631
  .. ..$ currentUsageTotal: int 526
  .. ..$ currentUsageCovid: int 18
  ..$ newCases                         : int 113
  ..$ newDeaths                        : int 1
  ..$ vaccinesDistributed              : NULL
  ..$ vaccinationsInitiated            : int 456528
  ..$ vaccinationsCompleted            : int 399804
  ..$ vaccinationsAdditionalDose       : int 216056
  ..$ vaccinesAdministered             : NULL
  ..$ vaccinesAdministeredDemographics : NULL
  ..$ vaccinationsInitiatedDemographics: NULL
 $ annotations                   :List of 28
  ..$ cases                          :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "NYTimes"
  .. .. ..$ url : chr "https://github.com/nytimes/covid-19-data"
  .. .. ..$ name: chr "The New York Times"
  .. ..$ anomalies: list()
  ..$ deaths                         :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "NYTimes"
  .. .. ..$ url : chr "https://github.com/nytimes/covid-19-data"
  .. .. ..$ name: chr "The New York Times"
  .. ..$ anomalies: list()
  ..$ positiveTests                  : NULL
  ..$ negativeTests                  : NULL
  ..$ contactTracers                 : NULL
  ..$ hospitalBeds                   :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/anag-cw7u"
  .. .. ..$ name: chr "Department of Health and Human Services"
  .. ..$ anomalies: list()
  ..$ hsaHospitalBeds                : NULL
  ..$ icuBeds                        :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/anag-cw7u"
  .. .. ..$ name: chr "Department of Health and Human Services"
  .. ..$ anomalies: list()
  ..$ hsaIcuBeds                     : NULL
  ..$ newCases                       :List of 2
  .. ..$ sources  : list()
  .. ..$ anomalies:'data.frame':    2 obs. of  3 variables:
  .. .. ..$ date                : chr [1:2] "2020-10-01" "2021-12-30"
  .. .. ..$ type                : chr [1:2] "zscore_outlier" "zscore_outlier"
  .. .. ..$ original_observation: num [1:2] 164 1664
  ..$ newDeaths                      : NULL
  ..$ vaccinesDistributed            : NULL
  ..$ vaccinationsInitiated          :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://data.cdc.gov/Vaccinations/COVID-19-Vaccinations-in-the-United-States-County/8xkx-amqh"
  .. .. ..$ name: chr "Centers for Disease Control and Prevention"
  .. ..$ anomalies: list()
  ..$ vaccinationsCompleted          :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://data.cdc.gov/Vaccinations/COVID-19-Vaccinations-in-the-United-States-County/8xkx-amqh"
  .. .. ..$ name: chr "Centers for Disease Control and Prevention"
  .. ..$ anomalies: list()
  ..$ vaccinationsAdditionalDose     :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://data.cdc.gov/Vaccinations/COVID-19-Vaccinations-in-the-United-States-County/8xkx-amqh"
  .. .. ..$ name: chr "Centers for Disease Control and Prevention"
  .. ..$ anomalies: list()
  ..$ vaccinesAdministered           : NULL
  ..$ testPositivityRatio            :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://data.cdc.gov/Public-Health-Surveillance/Weekly-COVID-19-County-Level-of-Community-Transmis/dt66-w6m6/"
  .. .. ..$ name: chr "Centers for Disease Control and Prevention"
  .. ..$ anomalies: list()
  ..$ caseDensity                    :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "NYTimes"
  .. .. ..$ url : chr "https://github.com/nytimes/covid-19-data"
  .. .. ..$ name: chr "The New York Times"
  .. ..$ anomalies: list()
  ..$ weeklyNewCasesPer100k          :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "NYTimes"
  .. .. ..$ url : chr "https://github.com/nytimes/covid-19-data"
  .. .. ..$ name: chr "The New York Times"
  .. ..$ anomalies: list()
  ..$ contactTracerCapacityRatio     : NULL
  ..$ infectionRate                  :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "NYTimes"
  .. .. ..$ url : chr "https://github.com/nytimes/covid-19-data"
  .. .. ..$ name: chr "The New York Times"
  .. ..$ anomalies: list()
  ..$ infectionRateCI90              :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "NYTimes"
  .. .. ..$ url : chr "https://github.com/nytimes/covid-19-data"
  .. .. ..$ name: chr "The New York Times"
  .. ..$ anomalies: list()
  ..$ icuCapacityRatio               :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/anag-cw7u"
  .. .. ..$ name: chr "Department of Health and Human Services"
  .. ..$ anomalies: list()
  ..$ bedsWithCovidPatientsRatio     :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/anag-cw7u"
  .. .. ..$ name: chr "Department of Health and Human Services"
  .. ..$ anomalies: list()
  ..$ weeklyCovidAdmissionsPer100k   :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "other"
  .. .. ..$ url : chr "https://healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/anag-cw7u"
  .. .. ..$ name: chr "Department of Health and Human Services"
  .. ..$ anomalies: list()
  ..$ vaccinationsInitiatedRatio     : NULL
  ..$ vaccinationsCompletedRatio     :List of 2
  .. ..$ sources  :'data.frame':    1 obs. of  3 variables:
  .. .. ..$ type: chr "CANScrapersStateProviders"
  .. .. ..$ url : chr "https://coronavirus.maryland.gov/#Vaccine"
  .. .. ..$ name: chr "Maryland Department of Health"
  .. ..$ anomalies: list()
  ..$ vaccinationsAdditionalDoseRatio: NULL
 $ lastUpdatedDate               : chr "2022-12-06"
 $ url                           : chr "https://covidactnow.org/us/maryland-md/county/baltimore_city"
 $ metricsTimeseries             :'data.frame': 1000 obs. of  13 variables:
  ..$ testPositivityRatio            : num [1:1000] 0 0 0.018 0.024 0.018 0.026 0.05 0.047 0.048 0.048 ...
  ..$ caseDensity                    : num [1:1000] 0 0 0 0 0 0 0 0.1 0.2 0.2 ...
  ..$ weeklyNewCasesPer100k          : num [1:1000] 0 0 0 0 0 0 0.3 1 1.3 1.7 ...
  ..$ contactTracerCapacityRatio     : logi [1:1000] NA NA NA NA NA NA ...
  ..$ infectionRate                  : num [1:1000] NA NA NA NA NA NA 1.4 1.42 1.44 1.45 ...
  ..$ infectionRateCI90              : num [1:1000] NA NA NA NA NA NA 0.96 0.7 0.6 0.56 ...
  ..$ icuCapacityRatio               : num [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ bedsWithCovidPatientsRatio     : num [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ weeklyCovidAdmissionsPer100k   : num [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ date                           : chr [1:1000] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-14" ...
  ..$ vaccinationsInitiatedRatio     : num [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ vaccinationsCompletedRatio     : num [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ vaccinationsAdditionalDoseRatio: num [1:1000] NA NA NA NA NA NA NA NA NA NA ...
 $ actualsTimeseries             :'data.frame': 1000 obs. of  19 variables:
  ..$ cases                            : int [1:1000] NA NA NA NA 1 1 3 7 7 11 ...
  ..$ deaths                           : int [1:1000] NA NA NA NA 0 0 0 0 0 0 ...
  ..$ positiveTests                    : logi [1:1000] NA NA NA NA NA NA ...
  ..$ negativeTests                    : logi [1:1000] NA NA NA NA NA NA ...
  ..$ contactTracers                   : logi [1:1000] NA NA NA NA NA NA ...
  ..$ hospitalBeds                     :'data.frame':   1000 obs. of  4 variables:
  .. ..$ capacity             : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageTotal    : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageCovid    : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ weeklyCovidAdmissions: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ hsaHospitalBeds                  :'data.frame':   1000 obs. of  4 variables:
  .. ..$ capacity             : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageTotal    : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageCovid    : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ weeklyCovidAdmissions: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ icuBeds                          :'data.frame':   1000 obs. of  3 variables:
  .. ..$ capacity         : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageTotal: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageCovid: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ hsaIcuBeds                       :'data.frame':   1000 obs. of  3 variables:
  .. ..$ capacity         : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageTotal: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ currentUsageCovid: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ newCases                         : int [1:1000] NA NA NA NA NA 0 2 4 0 4 ...
  ..$ newDeaths                        : int [1:1000] NA NA NA NA NA 0 0 0 0 0 ...
  ..$ vaccinesAdministeredDemographics : logi [1:1000] NA NA NA NA NA NA ...
  ..$ vaccinationsInitiatedDemographics: logi [1:1000] NA NA NA NA NA NA ...
  ..$ date                             : chr [1:1000] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-14" ...
  ..$ vaccinesDistributed              : logi [1:1000] NA NA NA NA NA NA ...
  ..$ vaccinationsInitiated            : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ vaccinationsCompleted            : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ vaccinationsAdditionalDose       : int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ vaccinesAdministered             : logi [1:1000] NA NA NA NA NA NA ...
 $ riskLevelsTimeseries          :'data.frame': 1000 obs. of  3 variables:
  ..$ overall    : int [1:1000] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ caseDensity: int [1:1000] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ date       : chr [1:1000] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-14" ...
 $ cdcTransmissionLevelTimeseries:'data.frame': 1000 obs. of  2 variables:
  ..$ date                : chr [1:1000] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-14" ...
  ..$ cdcTransmissionLevel: int [1:1000] 0 0 0 0 0 0 1 0 0 0 ...
 $ communityLevelsTimeseries     :'data.frame': 1000 obs. of  3 variables:
  ..$ cdcCommunityLevel: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ canCommunityLevel: int [1:1000] NA NA NA NA NA NA NA NA NA NA ...
  ..$ date             : chr [1:1000] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-14" ...</code></pre>
</div>
</div>
</div>
</div>
<p>Now that it is in a list format, you can see that it actually contains several data frames!</p>
<p>You can use this data right away if you are already familiar with lists in R, or you can extract the data frames into separate objects, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ts_df <span class="ot">&lt;-</span> covid_data<span class="sc">$</span>actualsTimeseries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data frame that we have just created contains many different variables and a lot of information. Below, you can see the first six rows of a selection of some interesting variables in our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ts_df[ , <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"deaths"</span>, <span class="st">"newCases"</span>, <span class="st">"newDeaths"</span>, <span class="st">"date"</span>)], <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cases deaths newCases newDeaths       date
1     NA     NA       NA        NA 2020-03-11
2     NA     NA       NA        NA 2020-03-12
3     NA     NA       NA        NA 2020-03-13
4     NA     NA       NA        NA 2020-03-14
5      1      0       NA        NA 2020-03-15
6      1      0        0         0 2020-03-16
7      3      0        2         0 2020-03-17
8      7      0        4         0 2020-03-18
9      7      0        0         0 2020-03-19
10    11      0        4         0 2020-03-20</code></pre>
</div>
</div>
</section>
<section id="looping-multiple-api-calls" class="level2">
<h2 class="anchored" data-anchor-id="looping-multiple-api-calls">Looping multiple API calls</h2>
<p>Next, let’s create a loop to make several requests to the API</p>
<p>Now that we’ve seen how to make an API call for one county, let’s create a simple loop to make several calls at a time. We’ll use a for loop, which you can read more about here.</p>
<p>First, we’ll create a vector with the ID code for each county we want to get data for:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Baltimore City County, Montgomery County, Baltimore County</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>counties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'24510'</span>, <span class="st">'24031'</span>, <span class="st">'24005'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will loop through each element and adjust the <code>API_URL</code> accordingly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>temp_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> <span class="dv">3</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ts_df <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(counties)) {</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build the API URL with the new county code</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  API_URL <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base, counties[i], info_key, covid_key)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the raw and processed API results in temporary objects</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  temp_raw <span class="ot">&lt;-</span> <span class="fu">GET</span>(API_URL)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  temp_list <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(temp_raw<span class="sc">$</span>content), <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the most recent results to your data frame</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  ts_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ts_df, temp_list<span class="sc">$</span>actualsTimeseries)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ts_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3007   29</code></pre>
</div>
</div>
</section>
</section>
<section id="post-lecture-materials" class="level1">
<h1>Post-lecture materials</h1>
<section id="other-good-r-packages-to-know-about" class="level2">
<h2 class="anchored" data-anchor-id="other-good-r-packages-to-know-about">Other good R packages to know about</h2>
<ul>
<li><a href="https://cran.r-project.org/web/packages/googlesheets4/index.html">googlesheets4</a> to interact with Google Sheets in R</li>
<li><a href="https://googledrive.tidyverse.org/">googledrive</a> to interact with files on your Google Drive</li>
</ul>
</section>
<section id="final-questions" class="level2">
<h2 class="anchored" data-anchor-id="final-questions">Final Questions</h2>
<p>Here are some post-lecture questions to help you think about the material discussed.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Using the GitHub API, access the repository information and ask how many open github issues you have?</li>
<li>Pick another API that we have not discussed here and use <code>httr</code> to retreive data from it.</li>
</ol>
</div>
</div>
</section>
<section id="additional-resources" class="level2">
<h2 class="anchored" data-anchor-id="additional-resources">Additional Resources</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://jeroen.cran.dev/jsonlite" class="uri">https://jeroen.cran.dev/jsonlite</a></li>
<li><a href="https://httr.r-lib.org" class="uri">https://httr.r-lib.org</a></li>
</ul>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>